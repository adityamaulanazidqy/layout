<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Now - Layout</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary-color: #977DFF;
            --accent-color: #2E49FA;
            --dark-color: #1A1A2E;
            --light-color: #FFFFFF;
            --gray-color: #F5F5F7;
            --text-color: #333333;
            --success-color: #28a745;
            --error-color: #dc3545;
            --success-gradient: linear-gradient(135deg, #28a745, #20c997);
            --error-gradient: linear-gradient(135deg, #dc3545, #e83e8c);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            color: var(--text-color);
            line-height: 1.6;
            background-color: var(--light-color);
            overflow-x: hidden;
        }

        /* Header & Navigation */
        header {
            background-color: var(--light-color);
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
            position: fixed;
            width: 100%;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        header.scrolled {
            padding: 5px 0;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            transition: all 0.3s ease;
        }

        .logo {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
        }

        .logo i {
            margin-right: 8px;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            align-items: center;
        }

        .nav-item {
            margin-left: 15px;
            position: relative;
        }

        .nav-link {
            color: var(--dark-color);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
            position: relative;
            padding: 8px 0;
        }

        .nav-link:after {
            content: '';
            position: absolute;
            width: 0;
            height: 3px;
            bottom: 0;
            left: 0;
            background-color: var(--primary-color);
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        .nav-link:hover:after {
            width: 100%;
        }

        .nav-link:hover {
            color: var(--primary-color);
        }

        .nav-link.active {
            color: var(--primary-color);
        }

        .nav-link.active:after {
            width: 100%;
        }

        .btn {
            display: inline-block;
            padding: 12px 28px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
            text-align: center;
            border: none;
            font-family: 'Poppins', sans-serif;
            font-size: 16px;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: var(--light-color);
            border: 2px solid var(--primary-color);
            box-shadow: 0 4px 10px rgba(151, 125, 255, 0.25);
        }

        .btn-primary:hover {
            background-color: transparent;
            color: var(--primary-color);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(151, 125, 255, 0.3);
        }

        .btn-outline {
            background-color: transparent;
            color: var(--accent-color);
            border: 2px solid var(--accent-color);
            box-shadow: 0 4px 10px rgba(46, 73, 250, 0.15);
        }

        .btn-outline:hover {
            background-color: var(--accent-color);
            color: var(--light-color);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(46, 73, 250, 0.3);
        }

        .hamburger {
            display: none;
            cursor: pointer;
            flex-direction: column;
            justify-content: space-between;
            width: 30px;
            height: 21px;
            z-index: 1001;
            position: relative;
        }

        .bar {
            display: block;
            width: 100%;
            height: 3px;
            background-color: var(--dark-color);
            transition: all 0.3s ease;
            border-radius: 3px;
        }

        /* Profile Section in Navigation */
        .profile-menu {
            position: relative;
            display: flex;
            align-items: center;
            margin-left: 15px;
        }

        .profile-toggle {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 50px;
            transition: all 0.3s ease;
            position: relative;
        }

        .profile-toggle:hover {
            background-color: rgba(151, 125, 255, 0.1);
        }

        .profile-img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 10px;
            border: 2px solid var(--primary-color);
        }

        .profile-name {
            font-weight: 500;
            color: var(--dark-color);
            margin-right: 5px;
        }

        .profile-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            width: 200px;
            background-color: var(--light-color);
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            padding: 10px 0;
            margin-top: 10px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .profile-menu.active .profile-dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .profile-dropdown a {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            color: var(--dark-color);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .profile-dropdown a:hover {
            background-color: rgba(151, 125, 255, 0.1);
            color: var(--primary-color);
        }

        .profile-dropdown a i {
            margin-right: 10px;
            width: 18px;
            text-align: center;
        }

        .divider {
            height: 1px;
            background-color: rgba(0, 0, 0, 0.1);
            margin: 5px 0;
        }

        /* Order Section */
        .order-container {
            padding: 160px 0 100px;
            background: linear-gradient(135deg, rgba(151, 125, 255, 0.05) 0%, rgba(46, 73, 250, 0.05) 100%);
            position: relative;
            overflow: hidden;
        }

        .order-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 80%, rgba(151, 125, 255, 0.08) 0%, transparent 40%),
                radial-gradient(circle at 80% 20%, rgba(46, 73, 250, 0.08) 0%, transparent 40%);
            z-index: 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 60px;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 1s ease forwards;
            position: relative;
            z-index: 1;
        }

        .section-title h2 {
            font-size: 2.5rem;
            color: var(--dark-color);
            margin-bottom: 15px;
            position: relative;
            display: inline-block;
            font-weight: 700;
        }

        .section-title h2:after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: linear-gradient(to right, var(--primary-color), var(--accent-color));
            border-radius: 2px;
        }

        .section-title p {
            font-size: 1.1rem;
            color: #666;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* PERBAIKAN PADDING ORDER-FORM */
        .order-form {
            background-color: var(--light-color);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 50px !important;
            /* Menambahkan !important untuk memastikan padding diterapkan */
            margin: 20px auto;
            border: 1px solid rgba(151, 125, 255, 0.1);
            position: relative;
            z-index: 1;
            max-width: 800px;
            box-sizing: border-box;
            /* Memastikan padding dihitung dengan benar */
        }

        .form-group {
            margin-bottom: 25px;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark-color);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(151, 125, 255, 0.2);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        .form-text {
            display: block;
            margin-top: 5px;
            font-size: 0.85rem;
            color: #6c757d;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
        }

        .checkbox-item input {
            margin-right: 10px;
        }

        .color-filter {
            margin-bottom: 15px;
        }

        .color-filter input {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }

        .color-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 10px;
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #eee;
            border-radius: 8px;
        }

        .color-option {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .color-option.selected {
            border-color: var(--primary-color);
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .color-checkbox {
            position: absolute;
            top: 5px;
            right: 5px;
            z-index: 2;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .color-checkbox input {
            display: none;
        }

        .color-checkbox i {
            display: none;
            font-size: 12px;
            color: var(--primary-color);
        }

        .color-option.selected .color-checkbox i {
            display: block;
        }

        .color-preview {
            height: 60px;
            width: 100%;
        }

        .color-info {
            padding: 10px;
            background-color: white;
            text-align: center;
        }

        .color-name {
            font-size: 0.9rem;
            font-weight: 500;
        }

        .color-hex {
            font-size: 0.8rem;
            color: #666;
        }

        .file-upload {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .file-upload:hover {
            border-color: var(--primary-color);
        }

        .file-upload i {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }

        .file-upload p {
            margin-bottom: 10px;
            color: #666;
        }

        .file-input {
            display: none;
        }

        .file-preview {
            margin-top: 15px;
            display: none;
        }

        .file-preview img {
            max-width: 100%;
            max-height: 200px;
            border-radius: 8px;
            margin-top: 10px;
        }

        .form-steps {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            padding: 0 20px;
            flex: 1;
            max-width: 200px;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #e9ecef;
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-bottom: 10px;
            z-index: 2;
        }

        .step.active .step-number {
            background-color: var(--primary-color);
            color: white;
        }

        .step.completed .step-number {
            background-color: var(--success-color);
            color: white;
        }

        .step-text {
            font-size: 0.85rem;
            color: #6c757d;
            text-align: center;
        }

        .step.active .step-text {
            color: var(--primary-color);
            font-weight: 500;
        }

        .step::before,
        .step::after {
            content: '';
            position: absolute;
            top: 20px;
            width: 50%;
            height: 2px;
            background-color: #e9ecef;
            z-index: 1;
        }

        .step::before {
            left: 0;
        }

        .step::after {
            right: 0;
        }

        .step:first-child::before {
            display: none;
        }

        .step:last-child::after {
            display: none;
        }

        .form-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        /* MODERN NOTIFICATION STYLES */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            max-width: 400px;
            width: 90%;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .notification {
            position: relative;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            padding: 20px;
            display: flex;
            align-items: flex-start;
            animation: slideInRight 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            transform: translateX(400px);
            opacity: 0;
            border-left: 4px solid;
            overflow: hidden;
        }

        .notification::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.7) 100%);
        }

        .notification.success {
            border-left-color: var(--success-color);
            background: linear-gradient(135deg, #f8fff9, #ffffff);
        }

        .notification.error {
            border-left-color: var(--error-color);
            background: linear-gradient(135deg, #fff8f9, #ffffff);
        }

        .notification-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            flex-shrink: 0;
            font-size: 20px;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .notification.success .notification-icon {
            background: var(--success-gradient);
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .notification.error .notification-icon {
            background: var(--error-gradient);
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }

        .notification-icon::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, transparent 50%);
            border-radius: 50%;
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            font-size: 18px;
            margin-bottom: 5px;
            color: var(--dark-color);
        }

        .notification.success .notification-title {
            color: var(--success-color);
        }

        .notification.error .notification-title {
            color: var(--error-color);
        }

        .notification-message {
            font-size: 14px;
            color: #555;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        .notification-progress {
            height: 3px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 10px;
        }

        .notification-progress-bar {
            height: 100%;
            width: 100%;
            border-radius: 2px;
            transition: width 0.1s linear;
        }

        .notification.success .notification-progress-bar {
            background: var(--success-gradient);
        }

        .notification.error .notification-progress-bar {
            background: var(--error-gradient);
        }

        .notification-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            color: #999;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .notification-close:hover {
            background-color: rgba(0, 0, 0, 0.05);
            color: #555;
        }

        /* Confetti effect for success */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: var(--primary-color);
            opacity: 0;
            z-index: 10000;
            pointer-events: none;
        }

        /* Modal for detailed messages */
        .notification-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .notification-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            transform: scale(0.9);
            transition: transform 0.3s ease;
            text-align: center;
        }

        .notification-modal.active .modal-content {
            transform: scale(1);
        }

        .modal-icon {
            font-size: 60px;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .modal-message {
            font-size: 16px;
            color: #555;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideInRight {
            from {
                transform: translateX(400px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .nav-menu {
                position: fixed;
                left: -100%;
                top: 0;
                flex-direction: column;
                background-color: var(--light-color);
                width: 80%;
                height: 100vh;
                box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
                transition: 0.4s;
                padding-top: 80px;
                z-index: 999;
                justify-content: flex-start;
                gap: 20px;
            }

            .nav-menu.active {
                left: 0;
            }

            .nav-item {
                margin: 0;
                width: 100%;
                text-align: center;
            }

            .nav-link {
                display: block;
                padding: 15px;
            }

            .hamburger {
                display: flex;
            }

            .hamburger.active .bar:nth-child(1) {
                transform: translateY(9px) rotate(45deg);
            }

            .hamburger.active .bar:nth-child(2) {
                opacity: 0;
            }

            .hamburger.active .bar:nth-child(3) {
                transform: translateY(-9px) rotate(-45deg);
            }

            .profile-menu {
                margin-left: 0;
                margin-top: 20px;
                width: 100%;
                justify-content: center;
            }

            .profile-dropdown {
                position: static;
                width: 100%;
                box-shadow: none;
                margin-top: 10px;
                opacity: 1;
                visibility: visible;
                transform: none;
                display: none;
            }

            .profile-menu.active .profile-dropdown {
                display: block;
            }

            .checkbox-group {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }

            /* Responsive notifications for tablet */
            .notification-container {
                right: 10px;
                left: 10px;
                max-width: none;
                width: auto;
            }

            .notification {
                padding: 15px;
            }

            .notification-icon {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
        }

        @media (max-width: 768px) {
            .order-container {
                padding: 140px 0 80px;
            }

            .section-title h2 {
                font-size: 2rem;
            }

            /* PERBAIKAN PADDING ORDER-FORM UNTUK TABLET */
            .order-form {
                padding: 40px 30px !important;
                /* Menambahkan !important untuk memastikan padding diterapkan */
            }

            .form-steps {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }

            .step {
                width: 100%;
                max-width: none;
            }

            .step::before,
            .step::after {
                display: none;
            }

            .color-options {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }

            .form-navigation {
                flex-direction: column;
                gap: 15px;
            }

            .btn {
                width: 100%;
            }

            /* Responsive notifications for mobile */
            .notification-container {
                top: 10px;
                right: 10px;
                left: 10px;
            }

            .notification {
                padding: 12px 15px;
            }

            .notification-title {
                font-size: 16px;
            }

            .notification-message {
                font-size: 13px;
            }

            .notification-icon {
                width: 35px;
                height: 35px;
                font-size: 16px;
                margin-right: 10px;
            }

            .modal-content {
                padding: 20px;
            }

            .modal-icon {
                font-size: 50px;
            }

            .modal-title {
                font-size: 20px;
            }

            .modal-actions {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .section-title h2 {
                font-size: 1.75rem;
            }

            .navbar {
                padding: 10px 0;
            }

            .logo {
                font-size: 24px;
            }

            /* PERBAIKAN PADDING ORDER-FORM UNTUK MOBILE */
            .order-form {
                padding: 30px 20px !important;
                /* Menambahkan !important untuk memastikan padding diterapkan */
            }

            .checkbox-group {
                grid-template-columns: 1fr;
            }

            .color-options {
                grid-template-columns: repeat(2, 1fr);
            }

            .profile-name {
                display: none;
            }

            /* Mobile notifications */
            .notification {
                flex-direction: column;
                text-align: center;
            }

            .notification-icon {
                margin-right: 0;
                margin-bottom: 10px;
                align-self: center;
            }
        }
    </style>
</head>

<body>
    <!-- Header & Navigation -->
    <header>
        <div class="container">
            <nav class="navbar">
                <a href="index.html" class="logo"><i class="fas fa-paint-brush"></i>Layout</a>
                <ul class="nav-menu">
                    <li class="nav-item"><a href="dashboard.html" class="nav-link">Home</a></li>
                    <li class="nav-item"><a href="dashboard.html" class="nav-link">Layanan</a></li>
                    <li class="nav-item"><a href="dashboard.html" class="nav-link">About Us</a></li>
                    <li class="nav-item"><a href="dashboard.html" class="nav-link">Kontak</a></li>
                    <li class="nav-item"><a href="#call-me" class="btn btn-outline">Call Me</a></li>

                    <!-- Profile Menu -->
                    <li class="nav-item profile-menu" id="profileMenu">
                        <div class="profile-toggle">
                            <img src="https://placehold.co/40x40/977DFF/FFFFFF?text=U" alt="Profile" class="profile-img"
                                id="profileImage">
                            <span class="profile-name" id="profileName">User Name</span>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div class="profile-dropdown">
                            <!-- <a href="#"><i class="fas fa-user"></i> Profil Saya</a> -->
                            <!-- <a href="setting.html"><i class="fas fa-cog"></i> Pengaturan</a> -->
                            <a href="#"><i class="fas fa-history"></i> Riwayat</a>
                            <div class="divider"></div>
                            <a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a>
                        </div>
                    </li>
                </ul>
                <div class="hamburger">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
            </nav>
        </div>
    </header>

    <!-- Order Section -->
    <section class="order-container">
        <div class="container">
            <div class="section-title">
                <h2>Pesan Website Anda Sekarang</h2>
                <p>Isi formulir di bawah ini untuk memesan website profesional sesuai kebutuhan bisnis Anda</p>
            </div>

            <!-- Form Steps -->
            <div class="form-steps">
                <div class="step active" id="step1">
                    <div class="step-number">1</div>
                    <div class="step-text">Informasi Dasar</div>
                </div>
                <div class="step" id="step2">
                    <div class="step-number">2</div>
                    <div class="step-text">Kebutuhan & Halaman</div>
                </div>
                <div class="step" id="step3">
                    <div class="step-number">3</div>
                    <div class="step-text">Desain & Referensi</div>
                </div>
            </div>

            <!-- Order Form -->
            <form class="order-form" id="orderForm" enctype="multipart/form-data">
                <!-- Step 1: Basic Information -->
                <div id="step1-content">
                    <div class="form-group">
                        <label for="company_name">Nama Perusahaan</label>
                        <input type="text" class="form-control" id="company_name" name="company_name" required>
                    </div>

                    <div class="form-group">
                        <label for="need_id">Kebutuhan Website</label>
                        <select class="form-control" id="need_id" name="need_id" required>
                            <option value="">Pilih kebutuhan website</option>
                            <!-- Options will be populated by JavaScript -->
                        </select>
                    </div>

                    <div class="form-navigation">
                        <button type="button" class="btn btn-outline" id="nextToStep2">Selanjutnya</button>
                    </div>
                </div>

                <!-- Step 2: Pages & Features -->
                <div id="step2-content" style="display: none;">
                    <div class="form-group">
                        <label>Pilih Halaman yang Diperlukan</label>
                        <div class="checkbox-group" id="pages-container">
                            <!-- Checkboxes will be populated by JavaScript -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Pilih Warna Website (Bisa pilih lebih dari satu)</label>
                        <div class="color-filter">
                            <input type="text" id="colorFilter" placeholder="Cari warna berdasarkan nama...">
                        </div>
                        <div class="color-options" id="colors-container">
                            <!-- Color options akan diisi oleh JavaScript -->
                        </div>
                    </div>

                    <div class="form-navigation">
                        <button type="button" class="btn btn-outline" id="prevToStep1">Kembali</button>
                        <button type="button" class="btn btn-primary" id="nextToStep3">Selanjutnya</button>
                    </div>
                </div>

                <!-- Step 3: Design & References -->
                <div id="step3-content" style="display: none;">
                    <div class="form-group">
                        <label for="logo_path">Upload Logo Perusahaan</label>
                        <div class="file-upload" id="logoUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Klik untuk upload logo</p>
                            <span>Format: JPG, PNG, SVG (Maks. 5MB)</span>
                            <input type="file" class="file-input" id="logo_path" name="logo_path" accept="image/*">
                        </div>
                        <div class="file-preview" id="logoPreview"></div>
                    </div>

                    <div class="form-group">
                        <label for="reference_link">Link Referensi Website (Opsional)</label>
                        <input type="url" class="form-control" id="reference_link" name="reference_link"
                            placeholder="https://contoh.com">
                    </div>

                    <div class="form-group">
                        <label for="reference_path">Upload Referensi Desain (Opsional)</label>
                        <div class="file-upload" id="referenceUpload">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>Klik untuk upload referensi desain</p>
                            <span>Format: JPG, PNG, PDF (Maks. 10MB)</span>
                            <input type="file" class="file-input" id="reference_path" name="reference_path"
                                accept="image/*,.pdf">
                        </div>
                        <div class="file-preview" id="referencePreview"></div>
                    </div>

                    <div class="form-group">
                        <label for="notes">Catatan Tambahan (Opsional)</label>
                        <textarea class="form-control" id="notes" name="notes"
                            placeholder="Jelaskan detail tambahan atau preferensi khusus untuk website Anda"></textarea>
                    </div>

                    <div class="form-navigation">
                        <button type="button" class="btn btn-outline" id="prevToStep2">Kembali</button>
                        <button type="submit" class="btn btn-primary" id="submitOrder">Pesan Sekarang</button>
                    </div>
                </div>
            </form>
        </div>
    </section>

    <!-- Notification System -->
    <div class="notification-container" id="notification-container"></div>

    <!-- Modal for detailed notifications -->
    <div class="notification-modal" id="notificationModal">
        <div class="modal-content">
            <div class="modal-icon" id="modalIcon"></div>
            <h3 class="modal-title" id="modalTitle"></h3>
            <p class="modal-message" id="modalMessage"></p>
            <div class="modal-actions">
                <button class="btn btn-primary" id="modalCloseBtn">Tutup</button>
                <button class="btn btn-outline" id="modalActionBtn" style="display: none;">Lihat Detail</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Mobile Menu Toggle
            const hamburger = document.querySelector(".hamburger");
            const navMenu = document.querySelector(".nav-menu");
            const body = document.body;
            const header = document.querySelector("header");

            if (hamburger) {
                hamburger.addEventListener("click", () => {
                    hamburger.classList.toggle("active");
                    navMenu.classList.toggle("active");

                    if (navMenu.classList.contains("active")) {
                        body.style.overflow = "hidden";
                    } else {
                        body.style.overflow = "auto";
                    }
                });

                document.querySelectorAll(".nav-link").forEach(n => n.addEventListener("click", () => {
                    hamburger.classList.remove("active");
                    navMenu.classList.remove("active");
                    body.style.overflow = "auto";
                }));
            }

            // Profile Menu Toggle
            const profileMenu = document.getElementById("profileMenu");
            const profileToggle = document.querySelector(".profile-toggle");

            profileToggle.addEventListener("click", (e) => {
                e.stopPropagation();
                profileMenu.classList.toggle("active");
            });

            // Close profile menu when clicking outside
            document.addEventListener("click", (e) => {
                if (!profileMenu.contains(e.target)) {
                    profileMenu.classList.remove("active");
                }
            });

            // Header scroll effect
            window.addEventListener('scroll', () => {
                if (window.scrollY > 50) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });

            // API Base URL
            const API_BASE_URL = 'http://localhost:3749/api/v1';

            // Token management
            let isRefreshing = false;
            let failedQueue = [];

            // Process queue after token refresh
            function processQueue(error, token = null) {
                failedQueue.forEach(promise => {
                    if (error) {
                        promise.reject(error);
                    } else {
                        promise.resolve(token);
                    }
                });
                failedQueue = [];
            }

            // Get token from storage
            function getToken() {
                return localStorage.getItem('token') || sessionStorage.getItem('token');
            }

            // Set token in storage
            function setToken(token) {
                // Simpan di tempat yang sama dengan token sebelumnya
                if (localStorage.getItem('token')) {
                    localStorage.setItem('token', token);
                } else {
                    sessionStorage.setItem('token', token);
                }
            }

            // Clear authentication data
            function clearAuthData() {
                localStorage.removeItem('token');
                sessionStorage.removeItem('token');
                localStorage.removeItem('role');
                // Tidak perlu clear refresh_token karena itu HttpOnly cookie
            }

            // Redirect to login page
            function redirectToLogin() {
                clearAuthData();
                window.location.href = 'login.html';
            }

            // Refresh token function
            async function refreshToken() {
                if (isRefreshing) {
                    return new Promise((resolve, reject) => {
                        failedQueue.push({ resolve, reject });
                    });
                }

                isRefreshing = true;

                try {
                    console.log('Attempting to refresh token...');
                    const response = await fetch(`${API_BASE_URL}/auth/refresh`, {
                        method: 'POST',
                        credentials: 'include', // Penting untuk mengirim cookies
                        headers: {
                            'Content-Type': 'application/json',
                        }
                    });

                    console.log('Refresh token response status:', response.status);

                    if (!response.ok) {
                        // Jika status 401, berarti refresh token juga expired/invalid
                        if (response.status === 401) {
                            console.log('Refresh token expired or invalid');
                            throw new Error('REFRESH_TOKEN_EXPIRED');
                        }
                        throw new Error(`Refresh failed: ${response.status} ${response.statusText}`);
                    }

                    const data = await response.json();
                    console.log('Refresh token response:', data);

                    if (!data.access_token) {
                        throw new Error('No access token in response');
                    }

                    // Store the new access token
                    setToken(data.access_token);

                    // Process all queued requests
                    processQueue(null, data.access_token);

                    console.log('Token refreshed successfully');
                    return data.access_token;
                } catch (error) {
                    console.error('Token refresh failed:', error);

                    // Jika refresh token expired, redirect ke login
                    if (error.message === 'REFRESH_TOKEN_EXPIRED') {
                        console.log('Redirecting to login due to expired refresh token');
                        redirectToLogin();
                    }

                    processQueue(error, null);
                    throw error;
                } finally {
                    isRefreshing = false;
                }
            }

            // Enhanced fetch with automatic token refresh
            async function authFetch(url, options = {}) {
                let token = getToken();

                if (!token) {
                    console.log('No token found, redirecting to login');
                    redirectToLogin();
                    return;
                }

                // Set default headers
                const headers = {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`,
                    ...options.headers
                };

                try {
                    // First attempt
                    let response = await fetch(`${API_BASE_URL}${url}`, {
                        ...options,
                        headers,
                        credentials: 'include'
                    });

                    console.log(`API ${url} response status:`, response.status);

                    // If token is expired, try to refresh
                    if (response.status === 401) {
                        console.log('Access token expired, attempting refresh...');
                        try {
                            const newToken = await refreshToken();
                            console.log('New token obtained:', newToken);

                            // Retry request with new token
                            headers['Authorization'] = `Bearer ${newToken}`;
                            response = await fetch(`${API_BASE_URL}${url}`, {
                                ...options,
                                headers,
                                credentials: 'include'
                            });

                            return response;
                        } catch (refreshError) {
                            console.error('Refresh token failed:', refreshError);
                            redirectToLogin();
                            throw refreshError;
                        }
                    }

                    return response;
                } catch (error) {
                    console.error(`Auth fetch error for ${url}:`, error);
                    throw error;
                }
            }

            // Universal API request handler
            async function apiRequest(endpoint, options = {}) {
                try {
                    const response = await authFetch(endpoint, options);

                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({ message: 'Unknown error' }));
                        throw new Error(errorData.message || `HTTP ${response.status}`);
                    }

                    return await response.json();
                } catch (error) {
                    console.error(`API Request failed for ${endpoint}:`, error);
                    throw error;
                }
            }

            // Universal API request handler for FormData (tanpa Content-Type header)
            async function apiRequestFormData(endpoint, options = {}) {
                try {
                    let token = getToken();

                    if (!token) {
                        console.log('No token found, redirecting to login');
                        redirectToLogin();
                        return;
                    }

                    // Set headers tanpa Content-Type untuk FormData
                    const headers = {
                        'Authorization': `Bearer ${token}`,
                        ...options.headers
                    };

                    // Remove Content-Type header untuk FormData
                    delete headers['Content-Type'];

                    let response = await fetch(`${API_BASE_URL}${endpoint}`, {
                        ...options,
                        headers,
                        credentials: 'include'
                    });

                    console.log(`API ${endpoint} response status:`, response.status);

                    // If token is expired, try to refresh
                    if (response.status === 401) {
                        console.log('Access token expired, attempting refresh...');
                        try {
                            const newToken = await refreshToken();
                            console.log('New token obtained:', newToken);

                            // Retry request with new token
                            headers['Authorization'] = `Bearer ${newToken}`;
                            response = await fetch(`${API_BASE_URL}${endpoint}`, {
                                ...options,
                                headers,
                                credentials: 'include'
                            });

                            return await response.json();
                        } catch (refreshError) {
                            console.error('Refresh token failed:', refreshError);
                            redirectToLogin();
                            throw refreshError;
                        }
                    }

                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({ message: 'Unknown error' }));
                        throw new Error(errorData.message || `HTTP ${response.status}`);
                    }

                    return await response.json();
                } catch (error) {
                    console.error(`API Request failed for ${endpoint}:`, error);
                    throw error;
                }
            }

            // Check if user is authenticated
            async function checkAuthentication() {
                const token = getToken();

                if (!token) {
                    console.log('No authentication token found, redirecting to login');
                    redirectToLogin();
                    return false;
                }

                try {
                    // Cek token expiration
                    const payload = JSON.parse(atob(token.split('.')[1]));
                    const exp = payload.exp * 1000;
                    const now = Date.now();
                    console.log('Token expires at:', new Date(exp));
                    console.log('Current time:', new Date(now));
                    console.log('Time until expiration:', (exp - now) / 1000 / 60, 'minutes');

                    // Verify token and get user role
                    const data = await apiRequest('/profile/role');
                    const role = data.role;
                    localStorage.setItem("role", role);
                    console.log('User role:', role);

                    // If user is admin, redirect to admin dashboard
                    if (role === 'admin') {
                        console.log('Admin user detected, redirecting to admin dashboard');
                        window.location.href = 'dashboard_admin.html';
                        return false;
                    }

                    // If user is client, continue with normal flow
                    console.log('Client user detected, continuing to order page');

                    // Token exists, fetch user profile
                    await fetchUserProfile();
                    return true;
                } catch (error) {
                    console.error('Error checking authentication:', error);
                    redirectToLogin();
                    return false;
                }
            }

            // Fetch user profile from API
            async function fetchUserProfile() {
                try {
                    const data = await apiRequest('/profile');

                    // Update profile information
                    document.getElementById('profileName').textContent = data.username || data.email;

                    // Fetch profile image if available
                    if (data.profile_path) {
                        await fetchProfileImage(data.profile_path);
                    }
                } catch (error) {
                    console.error('Error fetching profile:', error);
                }
            }

            // Fetch profile image from server
            async function fetchProfileImage(pathImage) {
                try {
                    const response = await authFetch(`/profile/image?path=${encodeURIComponent(pathImage)}`);

                    if (response.ok) {
                        const blob = await response.blob();
                        const imageUrl = URL.createObjectURL(blob);
                        document.getElementById('profileImage').src = imageUrl;
                    }
                } catch (error) {
                    console.error('Error fetching profile image:', error);
                }
            }

            // Logout functionality
            document.getElementById('logoutBtn').addEventListener('click', async (e) => {
                e.preventDefault();

                try {
                    // Panggil logout endpoint untuk clear server-side session
                    await fetch(`${API_BASE_URL}/logout`, {
                        method: 'POST',
                        credentials: 'include'
                    });
                } catch (error) {
                    console.error('Error during logout API call:', error);
                } finally {
                    // Clear client-side data dan redirect
                    clearAuthData();
                    window.location.href = 'index.html';
                }
            });

            // Auto refresh token before expiration (optional)
            function setupTokenAutoRefresh() {
                // Check token expiration every minute
                setInterval(async () => {
                    const token = getToken();
                    if (!token) return;

                    try {
                        // Decode token to check expiration
                        const payload = JSON.parse(atob(token.split('.')[1]));
                        const exp = payload.exp * 1000;
                        const now = Date.now();
                        const bufferTime = 5 * 60 * 1000; // 5 minutes buffer

                        // Refresh if token expires in less than buffer time
                        if (exp - now < bufferTime) {
                            console.log('Auto-refreshing token before expiration...');
                            await refreshToken();
                            console.log('Token auto-refreshed successfully');
                        }
                    } catch (error) {
                        console.error('Error in token auto-refresh:', error);
                    }
                }, 60 * 1000);
            }

            // Form Elements
            const step1Content = document.getElementById('step1-content');
            const step2Content = document.getElementById('step2-content');
            const step3Content = document.getElementById('step3-content');
            const step1Indicator = document.getElementById('step1');
            const step2Indicator = document.getElementById('step2');
            const step3Indicator = document.getElementById('step3');
            const nextToStep2 = document.getElementById('nextToStep2');
            const nextToStep3 = document.getElementById('nextToStep3');
            const prevToStep1 = document.getElementById('prevToStep1');
            const prevToStep2 = document.getElementById('prevToStep2');
            const submitOrder = document.getElementById('submitOrder');
            const orderForm = document.getElementById('orderForm');
            const colorFilter = document.getElementById('colorFilter');

            // Modal elements
            const notificationModal = document.getElementById('notificationModal');
            const modalIcon = document.getElementById('modalIcon');
            const modalTitle = document.getElementById('modalTitle');
            const modalMessage = document.getElementById('modalMessage');
            const modalCloseBtn = document.getElementById('modalCloseBtn');
            const modalActionBtn = document.getElementById('modalActionBtn');

            // Enhanced Notification system
            function showNotification(type, title, message, duration = 5000, showProgress = true) {
                const container = document.getElementById('notification-container');

                // Create notification element
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;

                // Set icon based on type
                const icon = type === 'success' ? 'fa-check' : 'fa-exclamation-triangle';

                notification.innerHTML = `
                <div class="notification-icon">
                    <i class="fas ${icon}"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-message">${message}</div>
                    ${showProgress ? '<div class="notification-progress"><div class="notification-progress-bar"></div></div>' : ''}
                </div>
                <button class="notification-close">
                    <i class="fas fa-times"></i>
                </button>
            `;

                // Add to container
                container.appendChild(notification);

                // Handle close button
                const closeBtn = notification.querySelector('.notification-close');
                closeBtn.addEventListener('click', () => {
                    removeNotification(notification);
                });

                // Auto remove after duration
                if (duration > 0) {
                    const progressBar = notification.querySelector('.notification-progress-bar');
                    if (progressBar) {
                        let width = 100;
                        const interval = duration / 100;
                        const timer = setInterval(() => {
                            if (width <= 0) {
                                clearInterval(timer);
                                removeNotification(notification);
                            } else {
                                width--;
                                progressBar.style.width = width + '%';
                            }
                        }, interval);
                    } else {
                        setTimeout(() => {
                            if (notification.parentNode) {
                                removeNotification(notification);
                            }
                        }, duration);
                    }
                }

                return notification;
            }

            function removeNotification(notification) {
                notification.style.animation = 'slideOutRight 0.5s ease forwards';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 500);
            }

            // Show modal notification
            function showModalNotification(type, title, message, actionText = null, actionCallback = null) {
                // Set modal content based on type
                const icon = type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle';
                const iconColor = type === 'success' ? 'var(--success-color)' : 'var(--error-color)';

                modalIcon.className = 'modal-icon';
                modalIcon.innerHTML = `<i class="fas ${icon}" style="color: ${iconColor}"></i>`;
                modalTitle.textContent = title;
                modalMessage.textContent = message;

                // Show/hide action button
                if (actionText && actionCallback) {
                    modalActionBtn.style.display = 'inline-block';
                    modalActionBtn.textContent = actionText;
                    modalActionBtn.onclick = actionCallback;
                } else {
                    modalActionBtn.style.display = 'none';
                }

                // Show modal
                notificationModal.classList.add('active');
            }

            // Close modal
            modalCloseBtn.addEventListener('click', () => {
                notificationModal.classList.remove('active');
            });

            // Close modal when clicking outside
            notificationModal.addEventListener('click', (e) => {
                if (e.target === notificationModal) {
                    notificationModal.classList.remove('active');
                }
            });

            // Confetti effect for success
            function createConfetti() {
                const colors = ['#977DFF', '#2E49FA', '#28a745', '#20c997', '#dc3545', '#e83e8c'];
                const container = document.body;

                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.width = Math.random() * 10 + 5 + 'px';
                    confetti.style.height = confetti.style.width;
                    confetti.style.animation = `confettiFall ${Math.random() * 3 + 2}s linear forwards`;

                    container.appendChild(confetti);

                    // Remove confetti after animation
                    setTimeout(() => {
                        if (confetti.parentNode) {
                            confetti.parentNode.removeChild(confetti);
                        }
                    }, 5000);
                }
            }

            // Helper functions for specific notification types
            function showSuccess(message, title = 'Berhasil', duration = 5000) {
                createConfetti();
                return showNotification('success', title, message, duration);
            }

            function showError(message, title = 'Error', duration = 5000) {
                return showNotification('error', title, message, duration);
            }

            // Load data from APIs
            async function loadFormData() {
                try {
                    // Load needs
                    const needsData = await apiRequest('/needs/list');
                    populateNeeds(needsData);

                    // Load pages
                    const pagesData = await apiRequest('/pages/list');
                    populatePages(pagesData);

                    // Load colors
                    const colorsData = await apiRequest('/colors/list');
                    populateColors(colorsData);

                } catch (error) {
                    console.error('Error loading form data:', error);
                    showError('Gagal memuat data formulir. Silakan refresh halaman.');
                }
            }

            // Populate needs dropdown
            function populateNeeds(needs) {
                const needsSelect = document.getElementById('need_id');
                needs.forEach(need => {
                    const option = document.createElement('option');
                    option.value = need.id;
                    option.textContent = need.name;
                    needsSelect.appendChild(option);
                });
            }

            // Populate pages checkboxes
            function populatePages(pages) {
                const pagesContainer = document.getElementById('pages-container');
                pages.forEach(page => {
                    const checkboxItem = document.createElement('div');
                    checkboxItem.className = 'checkbox-item';
                    checkboxItem.innerHTML = `
                    <input type="checkbox" id="page-${page.id}" name="pages_id" value="${page.id}">
                    <label for="page-${page.id}">${page.name}</label>
                `;
                    pagesContainer.appendChild(checkboxItem);
                });
            }

            // Populate color options
            function populateColors(colors) {
                const colorsContainer = document.getElementById('colors-container');
                colorsContainer.innerHTML = ''; // Clear previous content

                if (!colors || colors.length === 0) {
                    colorsContainer.innerHTML = '<p>Tidak ada data warna yang tersedia</p>';
                    return;
                }

                colors.forEach(color => {
                    // Pastikan properti hex_code ada dan valid
                    const hexCode = color.hex_code || '#FFFFFF';

                    const colorOption = document.createElement('div');
                    colorOption.className = 'color-option';
                    colorOption.dataset.colorId = color.id;
                    colorOption.dataset.colorName = color.name.toLowerCase();
                    colorOption.innerHTML = `
                    <div class="color-checkbox">
                        <input type="checkbox" id="color-${color.id}" name="colors_id" value="${color.id}">
                        <i class="fas fa-check"></i>
                    </div>
                    <div class="color-preview" style="background-color: ${hexCode};"></div>
                    <div class="color-info">
                        <div class="color-name">${color.name}</div>
                        <div class="color-hex">${hexCode}</div>
                    </div>
                `;

                    colorOption.addEventListener('click', (e) => {
                        // Jangan toggle jika klik pada checkbox
                        if (e.target.tagName === 'INPUT') return;

                        const checkbox = colorOption.querySelector('input');
                        checkbox.checked = !checkbox.checked;

                        if (checkbox.checked) {
                            colorOption.classList.add('selected');
                        } else {
                            colorOption.classList.remove('selected');
                        }
                    });

                    colorsContainer.appendChild(colorOption);
                });

                // Add filter functionality
                if (colorFilter) {
                    colorFilter.addEventListener('input', function () {
                        const filterText = this.value.toLowerCase();
                        const colorOptions = colorsContainer.querySelectorAll('.color-option');

                        colorOptions.forEach(option => {
                            const colorName = option.dataset.colorName;
                            if (colorName.includes(filterText)) {
                                option.style.display = 'block';
                            } else {
                                option.style.display = 'none';
                            }
                        });
                    });
                }
            }

            // Form navigation
            nextToStep2.addEventListener('click', function () {
                const companyName = document.getElementById('company_name').value;
                const needId = document.getElementById('need_id').value;

                if (!companyName || !needId) {
                    showError('Harap isi semua field yang diperlukan');
                    return;
                }

                step1Content.style.display = 'none';
                step2Content.style.display = 'block';

                step1Indicator.classList.remove('active');
                step2Indicator.classList.add('active');
            });

            nextToStep3.addEventListener('click', function () {
                const selectedPages = document.querySelectorAll('input[name="pages_id"]:checked');
                const selectedColors = document.querySelectorAll('input[name="colors_id"]:checked');

                if (selectedPages.length === 0) {
                    showError('Harap pilih minimal satu halaman');
                    return;
                }

                if (selectedColors.length === 0) {
                    showError('Harap pilih minimal satu warna');
                    return;
                }

                step2Content.style.display = 'none';
                step3Content.style.display = 'block';

                step2Indicator.classList.remove('active');
                step3Indicator.classList.add('active');
            });

            prevToStep1.addEventListener('click', function () {
                step2Content.style.display = 'none';
                step1Content.style.display = 'block';

                step2Indicator.classList.remove('active');
                step1Indicator.classList.add('active');
            });

            prevToStep2.addEventListener('click', function () {
                step3Content.style.display = 'none';
                step2Content.style.display = 'block';

                step3Indicator.classList.remove('active');
                step2Indicator.classList.add('active');
            });

            // File upload preview
            document.getElementById('logoUpload').addEventListener('click', function () {
                document.getElementById('logo_path').click();
            });

            document.getElementById('referenceUpload').addEventListener('click', function () {
                document.getElementById('reference_path').click();
            });

            document.getElementById('logo_path').addEventListener('change', function (e) {
                previewFile(e.target, 'logoPreview');
            });

            document.getElementById('reference_path').addEventListener('change', function (e) {
                previewFile(e.target, 'referencePreview');
            });

            function previewFile(input, previewId) {
                const preview = document.getElementById(previewId);
                const file = input.files[0];

                if (file) {
                    if (file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        reader.onload = function (e) {
                            preview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
                            preview.style.display = 'block';
                        };
                        reader.readAsDataURL(file);
                    } else {
                        preview.innerHTML = `<p>File: ${file.name}</p>`;
                        preview.style.display = 'block';
                    }
                }
            }

            // Form submission
            orderForm.addEventListener('submit', async function (e) {
                e.preventDefault();

                // Tampilkan indikator loading
                const originalText = submitOrder.textContent;
                submitOrder.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Memproses...';
                submitOrder.disabled = true;

                try {
                    const formData = new FormData();

                    // Add basic fields
                    formData.append('company_name', document.getElementById('company_name').value);
                    formData.append('need_id', document.getElementById('need_id').value);

                    // Add pages
                    document.querySelectorAll('input[name="pages_id"]:checked').forEach(checkbox => {
                        formData.append('pages_id', checkbox.value);
                    });

                    // Add colors (multiple)
                    document.querySelectorAll('input[name="colors_id"]:checked').forEach(checkbox => {
                        formData.append('colors_id', checkbox.value);
                    });

                    // Add optional fields
                    const referenceLink = document.getElementById('reference_link').value;
                    if (referenceLink) {
                        formData.append('reference_link', referenceLink);
                    }

                    const notes = document.getElementById('notes').value;
                    if (notes) {
                        formData.append('notes', notes);
                    }

                    // Add files
                    const logoFile = document.getElementById('logo_path').files[0];
                    if (logoFile) {
                        formData.append('logo_path', logoFile);
                    }

                    const referenceFile = document.getElementById('reference_path').files[0];
                    if (referenceFile) {
                        formData.append('reference_path', referenceFile);
                    }

                    const responseData = await apiRequestFormData('/orders/create', {
                        method: 'POST',
                        body: formData
                    });

                    // Show success modal with confetti
                    showModalNotification(
                        'success',
                        'Pesanan Berhasil!',
                        'Terima kasih! Pesanan website Anda telah berhasil dikirim. Tim kami akan menghubungi Anda dalam 1x24 jam untuk konfirmasi lebih lanjut.',
                        'Lihat Riwayat',
                        () => {
                            // Redirect to order history or dashboard
                            window.location.href = 'dashboard.html';
                        }
                    );

                    // Also show a small success notification
                    showSuccess('Pesanan berhasil dikirim!');

                    // Reset form
                    orderForm.reset();
                    document.querySelectorAll('.file-preview').forEach(preview => {
                        preview.style.display = 'none';
                        preview.innerHTML = '';
                    });

                    // Kembali ke step 1
                    step3Content.style.display = 'none';
                    step1Content.style.display = 'block';
                    step3Indicator.classList.remove('active');
                    step1Indicator.classList.add('active');

                } catch (error) {
                    console.error('Error submitting order:', error);

                    // Handle different error responses
                    let errorMessage = 'Gagal mengirim pesanan. Silakan coba lagi.';

                    if (error.message) {
                        errorMessage = error.message;
                    } else if (error.message && error.message.includes('413')) {
                        errorMessage = 'File yang diupload terlalu besar. Silakan pilih file yang lebih kecil.';
                    } else if (error.message && error.message.includes('415')) {
                        errorMessage = 'Format file tidak didukung. Silakan gunakan format JPG, PNG, atau PDF.';
                    }

                    // Show error modal
                    showModalNotification(
                        'error',
                        'Pesanan Gagal',
                        errorMessage
                    );

                    // Also show a small error notification
                    showError(errorMessage);
                } finally {
                    // Restore button state
                    submitOrder.textContent = originalText;
                    submitOrder.disabled = false;
                }
            });

            // Initialize form and check authentication
            checkAuthentication();
            loadFormData();

            // Initialize auto-refresh after successful authentication
            if (getToken()) {
                setupTokenAutoRefresh();
            }
        });
    </script>
</body>

</html>